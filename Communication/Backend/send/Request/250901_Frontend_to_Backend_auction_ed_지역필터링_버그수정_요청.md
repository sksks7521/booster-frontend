# [Frontend→Backend] auction_ed 지역 필터링 버그 수정 요청

## 📋 요청 개요

- **요청일**: 2025-09-01
- **요청자**: Frontend Team
- **우선순위**: 🚨 **High** (사용자 기능 완전 차단)
- **API**: `/api/v1/auction-completed/`
- **문제**: 지역 필터링 파라미터가 무시되어 전체 데이터가 반환됨

## 🚨 문제 상황

### **현재 증상**

- 사용자가 "경기도 고양시" 선택
- API 요청: `address_area=경기도&address_city=경기도 고양시`
- **실제 응답**: 전체 99,075개 데이터 (서울, 부산, 대구 등 모든 지역)
- **기대 응답**: 경기도 고양시 데이터만 필터링된 결과

### **재현 방법**

1. 프론트엔드에서 다음 URL 접속:

   ```
   http://localhost:3000/analysis/10071/v2?ds=auction_ed&province=경기도&cityDistrict=경기도 고양시
   ```

2. 실제 API 호출 확인:

   ```
   GET /api/v1/auction-completed/?address_area=경기도&address_city=경기도 고양시&page=1&size=20
   ```

3. **문제 확인**:
   - 응답 `total`: 99,075 (전체 데이터)
   - 첫 번째 아이템: `서울특별시 구로구 고척동 57-197` ❌
   - 기대 결과: `경기도 고양시 xxx` ✅

## 🔍 기술적 분석

### **프론트엔드 상태 (정상)**

✅ 지역 선택 UI: 정상 작동
✅ 필터 매핑: `province` → `address_area`, `cityDistrict` → `address_city`
✅ API 파라미터 전달: 올바른 파라미터로 호출

### **백엔드 상태 (문제)**

❌ **지역 필터링 로직 미작동**

- `address_area` 파라미터 무시
- `address_city` 파라미터 무시
- 전체 데이터 반환

## 📊 상세 디버깅 로그

### **API 요청 파라미터 (프론트엔드에서 전송)**

```json
{
  "address_area": "경기도",
  "address_city": "경기도 고양시",
  "page": 1,
  "size": 20
}
```

### **API 응답 (백엔드에서 반환)**

```json
{
  "items": [
    {
      "id": "156360",
      "address": "서울특별시 구로구 고척동 57-197", // ❌ 잘못된 지역
      "road_address": "서울특별시 구로구 고척동 57-197",
      "price": 24295.55,
      "area": 29.886239999999997
    }
    // ... 19개 더 (모두 다른 지역 데이터)
  ],
  "total": 99075, // ❌ 전체 데이터 개수
  "page": 1,
  "size": 20
}
```

### **기대 응답**

```json
{
  "items": [
    {
      "id": "xxxxx",
      "address": "경기도 고양시 일산동구 xxx",  // ✅ 올바른 지역
      "road_address": "경기도 고양시 일산동구 xxx",
      "price": xxxxx,
      "area": xxxxx
    }
    // ... 경기도 고양시 데이터만
  ],
  "total": 2888,  // ✅ 경기도 고양시 데이터 개수 (CSV 기준)
  "page": 1,
  "size": 20
}
```

## 🔧 요청 사항

### **1. 지역 필터링 로직 구현/수정**

**필요한 필터링 조건**:

```sql
-- 예상 SQL (참고용)
SELECT * FROM auction_completed
WHERE address_area = '경기도'
  AND address_city = '경기도 고양시'
  AND ... (기타 조건)
ORDER BY ...
LIMIT 20 OFFSET 0;
```

### **2. 필터 파라미터 검증**

다음 파라미터들이 올바르게 처리되는지 확인:

- `address_area`: 시도 필터링 (예: "경기도", "서울특별시")
- `address_city`: 시군구 필터링 (예: "경기도 고양시", "서울특별시 강남구")

### **3. 테스트 케이스**

| 요청 파라미터                                            | 기대 결과                       |
| -------------------------------------------------------- | ------------------------------- |
| `address_area=경기도&address_city=경기도 고양시`         | 경기도 고양시 데이터만 반환     |
| `address_area=서울특별시&address_city=서울특별시 강남구` | 서울특별시 강남구 데이터만 반환 |
| `address_area=부산광역시` (city 없음)                    | 부산광역시 전체 데이터 반환     |
| 필터 없음                                                | 전체 데이터 반환 (현재와 동일)  |

## 📅 일정 및 우선순위

### **우선순위**: 🚨 **High**

- **이유**: 사용자가 지역 선택 기능을 전혀 사용할 수 없음
- **영향도**: v2 경매결과 페이지 핵심 기능 차단

### **요청 일정**

- **수정 완료**: 가능한 빠른 시일 내 (1-2일 내)
- **테스트**: 수정 후 프론트엔드에서 즉시 테스트 가능

## 🤝 협업 방안

### **수정 완료 후 알림**

다음 방법 중 하나로 알림 부탁드립니다:

1. 이 문서에 완료 보고서 작성
2. 별도 완료 보고서 작성: `Communication/Backend/send/Completed/250901_...완료보고.md`

### **테스트 지원**

- 프론트엔드에서 즉시 테스트 가능
- 추가 테스트 케이스 필요 시 협의

## 📎 참고 자료

### **관련 문서**

- [250830*Backend_to_Frontend_auction_ed*스키마*공유*및*예시*응답.md](../receive/Request/250830_Backend_to_Frontend_auction_ed_스키마_공유_및_예시_응답.md)
- 백엔드 스키마에서 `address_area`, `address_city` 필드 확인 가능

### **프론트엔드 구현 상태**

- ✅ 지역 선택 UI 완료
- ✅ 필터 매핑 로직 완료
- ✅ API 호출 파라미터 전달 완료
- ⏳ **백엔드 지역 필터링 대기 중**

---

**문의사항이나 추가 정보가 필요하시면 언제든 연락 부탁드립니다.**

**Frontend Team**  
**2025-09-01**
