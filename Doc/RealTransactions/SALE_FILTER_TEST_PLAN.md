# 실거래가(매매) 필터 브라우저 테스트 계획

**작성일**: 2025-10-02  
**테스트 대상**: `SaleFilter.tsx` (Phase 3 완료)  
**테스트 환경**: `http://localhost:3000/analysis/[id]/v2?ds=sale`

---

## 📋 테스트 시나리오

### 1. 페이지 접근 및 초기 로딩 ✅

**테스트 URL:**
```
http://localhost:3000/analysis/10071/v2?ds=sale&province=경기도&cityDistrict=경기도%20고양시
```

**예상 결과:**
- [x] 페이지 로딩 성공
- [x] `SaleFilter` 컴포넌트 렌더링
- [x] `SaleSearchResults` 컴포넌트 렌더링
- [x] URL 파라미터에서 지역 필터 복원
- [x] 기본 정렬: `contractDate desc`

---

### 2. 지역 필터 테스트

#### 2-1. 시/도 선택
**액션:**
1. 시/도 드롭다운 클릭
2. "경기도" 선택

**예상 결과:**
- [ ] 시군구 드롭다운 활성화
- [ ] 읍면동 드롭다운 비활성화
- [ ] URL 파라미터 업데이트: `?province=경기도`

#### 2-2. 시군구 선택
**액션:**
1. 시군구 드롭다운 클릭
2. "경기도 고양시" 선택

**예상 결과:**
- [ ] 읍면동 드롭다운 활성화
- [ ] URL 파라미터 업데이트: `?province=경기도&cityDistrict=경기도%20고양시`
- [ ] API 호출: `sido=경기도&sigungu=경기도%20고양시`

#### 2-3. 읍면동 선택 (선택사항)
**액션:**
1. 읍면동 드롭다운 클릭
2. "원흥동" 선택

**예상 결과:**
- [ ] URL 파라미터 업데이트: `...&town=원흥동`
- [ ] API 호출: `...&admin_dong_name=원흥동`

#### 2-4. 읍면동 "전체" 선택
**액션:**
1. 읍면동 드롭다운 클릭
2. "전체" 선택

**예상 결과:**
- [ ] URL 파라미터: `town` 제거 또는 빈 값
- [ ] API 호출: `admin_dong_name` 미전달 (시군구 전체 조회)

#### 2-5. 계단식 선택 동작
**액션:**
1. 시/도 변경 (경기도 → 서울특별시)

**예상 결과:**
- [ ] 시군구 초기화 (빈 값)
- [ ] 읍면동 초기화 (빈 값)
- [ ] 시군구/읍면동 드롭다운 비활성화

---

### 3. 거래금액 필터 테스트

#### 3-1. Slider 모드
**액션:**
1. 거래금액 Slider 드래그 (예: 5,000만원 ~ 10,000만원)

**예상 결과:**
- [ ] 라벨 색상 변경 (회색 → 파란색)
- [ ] Slider 값 실시간 표시
- [ ] URL 파라미터 업데이트: `?transactionAmountRange=5000,10000`

#### 3-2. Input 모드
**액션:**
1. 토글 버튼 클릭 (Slider → Input)
2. 최소: 3,000만원, 최대: 8,000만원 입력

**예상 결과:**
- [ ] Input 필드 표시
- [ ] 값 입력 후 필터 적용
- [ ] URL 파라미터 업데이트: `?transactionAmountRange=3000,8000`

#### 3-3. 프리셋: 고액 매매
**액션:**
1. 상단 프리셋 버튼 "고액 매매 (10억 이상)" 클릭

**예상 결과:**
- [ ] 거래금액 범위 자동 설정: [100,000 ~ 500,000]
- [ ] 라벨 파란색 강조
- [ ] URL 파라미터 반영

---

### 4. 전용면적 필터 테스트

#### 4-1. Slider 모드
**액션:**
1. 전용면적 Slider 드래그 (예: 50㎡ ~ 100㎡)

**예상 결과:**
- [ ] 라벨 색상 변경 (회색 → 파란색)
- [ ] Slider 값 실시간 표시
- [ ] URL 파라미터 업데이트: `?exclusiveAreaRange=50,100`

#### 4-2. Input 모드
**액션:**
1. 토글 버튼 클릭 (Slider → Input)
2. 최소: 30㎡, 최대: 80㎡ 입력

**예상 결과:**
- [ ] Input 필드 표시
- [ ] 값 입력 후 필터 적용
- [ ] URL 파라미터 업데이트: `?exclusiveAreaRange=30,80`

#### 4-3. 프리셋: 소형 아파트
**액션:**
1. 상단 프리셋 버튼 "소형 아파트 (33평 이하)" 클릭

**예상 결과:**
- [ ] 전용면적 범위 자동 설정: [0 ~ 110]
- [ ] 라벨 파란색 강조
- [ ] URL 파라미터 반영

---

### 5. 건축연도 필터 테스트

#### 5-1. Slider 모드
**액션:**
1. 건축연도 Slider 드래그 (예: 2000년 ~ 2020년)

**예상 결과:**
- [ ] 라벨 색상 변경 (회색 → 파란색)
- [ ] Slider 값 실시간 표시
- [ ] URL 파라미터 업데이트: `?buildYearRange=2000,2020`

#### 5-2. Input 모드
**액션:**
1. 토글 버튼 클릭 (Slider → Input)
2. 시작년도: 2010, 종료년도: 2024 입력

**예상 결과:**
- [ ] Input 필드 표시
- [ ] 값 입력 후 필터 적용
- [ ] URL 파라미터 업데이트: `?buildYearRange=2010,2024`

#### 5-3. 프리셋: 신축 매매
**액션:**
1. 상단 프리셋 버튼 "신축 매매 (5년 이내)" 클릭

**예상 결과:**
- [ ] 건축연도 범위 자동 설정: [2019 ~ 2024]
- [ ] 라벨 파란색 강조
- [ ] URL 파라미터 반영

---

### 6. 거래 날짜 필터 테스트

#### 6-1. 빠른 선택: 최근 1개월
**액션:**
1. "최근 1개월" 버튼 클릭

**예상 결과:**
- [ ] 시작일: 2024-09-02 (1개월 전)
- [ ] 종료일: 2024-10-02 (오늘)
- [ ] Input 필드에 자동 입력
- [ ] 라벨 파란색 강조
- [ ] URL 파라미터 업데이트

#### 6-2. 빠른 선택: 최근 3개월
**액션:**
1. "최근 3개월" 버튼 클릭

**예상 결과:**
- [ ] 시작일: 2024-07-02
- [ ] 종료일: 2024-10-02
- [ ] URL 파라미터 업데이트

#### 6-3. 빠른 선택: 최근 6개월
**액션:**
1. "최근 6개월" 버튼 클릭

**예상 결과:**
- [ ] 시작일: 2024-04-02
- [ ] 종료일: 2024-10-02
- [ ] URL 파라미터 업데이트

#### 6-4. 빠른 선택: 올해
**액션:**
1. "올해" 버튼 클릭

**예상 결과:**
- [ ] 시작일: 2024-01-01
- [ ] 종료일: 2024-10-02
- [ ] URL 파라미터 업데이트

#### 6-5. 직접 입력
**액션:**
1. 시작일: 2024-01-01 입력
2. 종료일: 2024-03-31 입력

**예상 결과:**
- [ ] Input 필드 값 반영
- [ ] 라벨 파란색 강조
- [ ] URL 파라미터 업데이트: `?dateRange=2024-01-01,2024-03-31`

---

### 7. 초기화 버튼 테스트

#### 7-1. 필터 초기화 (지역 유지)
**액션:**
1. 여러 필터 적용 (거래금액, 면적, 건축연도, 날짜)
2. "모든 필터 초기화" 버튼 클릭

**예상 결과:**
- [ ] 지역 필터 (province, cityDistrict, town) **유지**
- [ ] 거래금액: [0, 100000] 복원
- [ ] 전용면적: [0, 300] 복원
- [ ] 건축연도: [1980, 2024] 복원
- [ ] 거래 날짜: 빈 값 복원
- [ ] 모든 필터 라벨 회색으로 복원
- [ ] 페이지: 1로 복원

---

### 8. 프리셋 통합 테스트

#### 8-1. 고액 매매 프리셋
**액션:**
1. 프리셋 버튼 "고액 매매 (10억 이상)" 클릭

**예상 결과:**
- [ ] 거래금액: [100,000 ~ 500,000] 설정
- [ ] 다른 필터 유지
- [ ] URL 파라미터 반영

#### 8-2. 소형 아파트 프리셋
**액션:**
1. 프리셋 버튼 "소형 아파트 (33평 이하)" 클릭

**예상 결과:**
- [ ] 전용면적: [0 ~ 110] 설정
- [ ] 다른 필터 유지
- [ ] URL 파라미터 반영

#### 8-3. 신축 매매 프리셋
**액션:**
1. 프리셋 버튼 "신축 매매 (5년 이내)" 클릭

**예상 결과:**
- [ ] 건축연도: [2019 ~ 2024] 설정
- [ ] 다른 필터 유지
- [ ] URL 파라미터 반영

---

### 9. URL 딥링크 테스트

#### 9-1. URL 파라미터 복원
**테스트 URL:**
```
http://localhost:3000/analysis/10071/v2?ds=sale&province=경기도&cityDistrict=경기도%20고양시&town=원흥동&transactionAmountRange=5000,10000&exclusiveAreaRange=50,100&buildYearRange=2010,2020&dateRange=2024-01-01,2024-03-31
```

**예상 결과:**
- [ ] 모든 필터 값 URL에서 복원
- [ ] 지역: 경기도 > 경기도 고양시 > 원흥동
- [ ] 거래금액: 5,000 ~ 10,000만원
- [ ] 전용면적: 50 ~ 100㎡
- [ ] 건축연도: 2010 ~ 2020년
- [ ] 거래 날짜: 2024-01-01 ~ 2024-03-31
- [ ] 모든 활성화된 필터 라벨 파란색

#### 9-2. URL 공유 및 재접속
**액션:**
1. 필터 적용 후 URL 복사
2. 새 탭에서 복사한 URL 접속

**예상 결과:**
- [ ] 동일한 필터 상태 복원
- [ ] 동일한 검색 결과 표시

---

### 10. API 파라미터 검증

#### 10-1. Network 탭 확인
**액션:**
1. 브라우저 개발자 도구 Network 탭 열기
2. 필터 적용 후 API 호출 확인

**예상 확인 사항:**
- [ ] API URL: `/api/v1/real-transactions/`
- [ ] 쿼리 파라미터:
  - `sido`: 시/도 값
  - `sigungu`: 시군구 값
  - `admin_dong_name`: 읍면동 값 (선택 시)
  - `ordering`: `-contract_date` (기본 정렬)
  - `page`: 페이지 번호
  - `size`: 페이지 크기 (기본 20)

#### 10-2. 정렬 파라미터 검증
**액션:**
1. 테이블 헤더에서 "거래금액" 클릭 (내림차순)

**예상 결과:**
- [ ] API 호출: `ordering=-transaction_amount`
- [ ] 테이블 정렬 반영

#### 10-3. 페이지네이션 검증
**액션:**
1. 페이지 2 클릭

**예상 결과:**
- [ ] API 호출: `page=2`
- [ ] URL 파라미터: `?page=2`

---

## 🐛 알려진 이슈

### 이슈 #1: 0건 결과 (미해결)
- **상태**: 🔴 미해결
- **증상**: 지역 선택 후 검색 결과 0건
- **원인 후보**:
  1. 백엔드 API 파라미터 불일치
  2. `registry.ts` 매핑 오류
  3. 실제 데이터 부재
- **해결 예정**: Phase 4 이전

---

## 📊 테스트 결과 요약

### 완료 항목
- [ ] 1. 페이지 접근 및 초기 로딩
- [ ] 2. 지역 필터 (5개 시나리오)
- [ ] 3. 거래금액 필터 (3개 시나리오)
- [ ] 4. 전용면적 필터 (3개 시나리오)
- [ ] 5. 건축연도 필터 (3개 시나리오)
- [ ] 6. 거래 날짜 필터 (5개 시나리오)
- [ ] 7. 초기화 버튼
- [ ] 8. 프리셋 통합 (3개)
- [ ] 9. URL 딥링크 (2개 시나리오)
- [ ] 10. API 파라미터 검증 (3개 시나리오)

**총 시나리오:** 28개

---

## 📝 테스트 실행 방법

### 수동 테스트
1. `npm run dev` 실행
2. 브라우저에서 `http://localhost:3000/analysis/10071/v2?ds=sale&province=경기도&cityDistrict=경기도%20고양시` 접속
3. 위 시나리오 순서대로 테스트
4. 각 항목 체크박스 표시

### 자동 테스트 (TODO)
- Playwright E2E 테스트 작성 예정
- `tests/e2e/sale-filter.spec.ts`

---

## 🎯 다음 단계

### Phase 4 준비사항
1. **0건 이슈 해결**: registry.ts 필터 매핑 확인
2. **검색 결과 컴포넌트**: SaleSearchResults.tsx 검증
3. **지도 연동**: 마커/범례 동작 확인
4. **테이블 정렬**: sortable_columns 연동 확인
5. **페이지네이션**: 동작 확인

---

**테스트 완료 후 체크리스트:**
- [ ] 모든 필터 정상 동작
- [ ] URL 딥링크 정상 동작
- [ ] API 파라미터 정확한 매핑
- [ ] 프리셋 정상 적용
- [ ] 초기화 버튼 정상 동작
- [ ] 0건 이슈 원인 파악


